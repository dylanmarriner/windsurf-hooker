{
  "_comment": "ATLAS-GATE Windsurf Policy: MCP-only sandbox enforcement",
  "profile": "atlas_windsurf_exec_mutation",
  "mcp_tool_allowlist": [
    "begin_session",
    "read_prompt",
    "list_plans",
    "read_file",
    "write_file",
    "read_audit_log",
    "verify_workspace_integrity",
    "replay_execution",
    "generate_attestation_bundle",
    "verify_attestation_bundle",
    "export_attestation_bundle",
    "bootstrap_create_foundation_plan",
    "lint_plan",
    "mcp_atlas-gate-mcp_begin_session",
    "mcp_atlas-gate-mcp_read_prompt",
    "mcp_atlas-gate-mcp_list_plans",
    "mcp_atlas-gate-mcp_read_file",
    "mcp_atlas-gate-mcp_write_file",
    "mcp_atlas-gate-mcp_read_audit_log",
    "mcp_atlas-gate-mcp_verify_workspace_integrity",
    "mcp_atlas-gate-mcp_replay_execution",
    "mcp_atlas-gate-mcp_generate_attestation_bundle",
    "mcp_atlas-gate-mcp_verify_attestation_bundle",
    "mcp_atlas-gate-mcp_export_attestation_bundle",
    "mcp_atlas-gate-mcp_bootstrap_create_foundation_plan",
    "mcp_atlas-gate-mcp_lint_plan"
  ],
  "block_commands_regex": [
    ".*"
  ],
  "filesystem": {
    "direct_read": false,
    "direct_write": false,
    "direct_exec": false,
    "comment": "All filesystem operations must route through ATLAS-GATE tools"
  },
  "tokens": {
    "audit_ok": "[AUDIT_OK]",
    "ship_ok": "[SHIP:GATES_OK]",
    "comment": "Legacy; plan hashes are now the authority"
  },
  "prohibited_patterns": {
    "placeholders": [
      "TODO",
      "TO-DO",
      "TBD",
      "FIXME",
      "XXX",
      "pass",
      "unimplemented",
      "stub",
      "dummy",
      "null",
      "placeholder",
      "sample",
      "example-only",
      "fake",
      "scaffold",
      "skeleton",
      "partial"
    ],
    "comments_and_notes": [
      "HACK",
      "\\bTEMP\\b",
      "future-work",
      "left as an exercise",
      "explanatory prose"
    ],
    "incomplete_code": [
      "\\.\\.\\.",
      "omitted section",
      "commented.?out",
      "pseudocode",
      "ellipsis"
    ],
    "mock_artifacts": [
      "mock data",
      "fake data",
      "demo data",
      "hardcoded test",
      "mock\\(",
      "Mock\\b",
      "stub\\(",
      "spy\\(",
      "synthetic fixture",
      "fake value"
    ],
    "assumptions_and_deferred": [
      "assume",
      "\\btemporary\\b",
      "for now",
      "workaround",
      "deferred",
      "user-dependent"
    ],
    "escape_attempts": [
      "os\\.system",
      "subprocess",
      "exec\\(",
      "eval\\(",
      "\\bopen\\(",
      "Runtime\\.getRuntime\\(\\)\\.exec",
      "ProcessBuilder",
      "java\\.lang\\.Runtime"
    ],
    "command_execution_patterns": [
      "\\bpopen\\b",
      "\\bsystem\\b",
      "\\bshell\\s*=",
      "\\bshell\\s*:",
      "Popen",
      "ShellExecute",
      "WinExec",
      "CreateProcess",
      "execve",
      "fork\\s*\\(",
      "spawn",
      "\\bsh\\b",
      "\\bbash\\b",
      "\\bcmd\\b",
      "powershell",
      "\\brm\\b",
      "\\bcp\\b",
      "\\bmv\\b",
      "\\brm\\s*-rf",
      "\\bsudo\\b",
      "\\bsu\\b",
      "#!/bin/",
      "#!/usr/bin/"
    ],
    "code_execution_bypass": [
      "__import__\\(",
      "compile\\(",
      "load_source",
      "\\bexec\\b",
      "\\beval\\b",
      "getattr\\(",
      "setattr\\(",
      "globals\\(",
      "locals\\(",
      "vars\\(",
      "\\breflect\\.",
      "\\bimportlib\\.",
      "require\\(.*require",
      "dynamic.*require",
      "__code__",
      "__func__",
      "MethodHandle",
      "reflection",
      "ClassLoader"
    ],
    "tool_bypass_patterns": [
      "direct.*file",
      "bypass.*atlas",
      "skip.*validation",
      "disable.*enforcement",
      "override.*policy",
      "ignore.*hook",
      "force.*write",
      "raw.*command",
      "native.*code",
      "\\bunsafe\\b",
      "FFI",
      "ctypes\\.",
      "cffi\\.",
      "jni\\."
    ],
    "network_command_execution": [
      "curl\\s",
      "wget\\s",
      "nc\\s",
      "telnet\\s",
      "ssh\\s",
      "rsh\\s",
      "socat\\s",
      "netcat",
      "\\|\\s*sh",
      "\\|\\s*bash",
      "&&\\s*bash",
      ";\\s*bash"
    ]
  },
  "language_support": {
    "supported_languages": [
      "python",
      "javascript",
      "typescript",
      "java",
      "c",
      "cpp",
      "csharp",
      "go",
      "rust",
      "php",
      "ruby",
      "swift",
      "kotlin",
      "r",
      "matlab"
    ],
    "comment": "All rules apply uniformly across these 15 languages"
  },
  "testing_requirements": {
    "coverage_minimum": 100,
    "coverage_type": "line and branch",
    "mock_usage": "forbidden",
    "comment": "Real implementations and real data paths only",
    "language_standards": {
      "python": {
        "framework": "pytest",
        "coverage_tool": "coverage.py with branch enabled",
        "command": "pytest --cov=src --cov-branch --cov-report=term-missing"
      },
      "javascript": {
        "framework": "Jest or Vitest",
        "coverage_tool": "built-in coverage",
        "command": "jest --coverage --collectCoverageFrom='src/**/*.js'"
      },
      "typescript": {
        "framework": "Jest or Vitest",
        "coverage_tool": "built-in coverage",
        "command": "jest --coverage --collectCoverageFrom='src/**/*.ts'"
      },
      "java": {
        "framework": "JUnit 5",
        "coverage_tool": "JaCoCo with branch coverage",
        "command": "mvn clean test jacoco:report"
      },
      "c": {
        "framework": "Catch2 or GoogleTest",
        "coverage_tool": "gcov or llvm-cov",
        "command": "cmake --build . && ctest && gcov ."
      },
      "cpp": {
        "framework": "Catch2 or GoogleTest",
        "coverage_tool": "gcov or llvm-cov",
        "command": "cmake --build . && ctest && gcov ."
      },
      "csharp": {
        "framework": "xUnit or NUnit",
        "coverage_tool": "coverlet",
        "command": "dotnet test /p:CollectCoverage=true"
      },
      "go": {
        "framework": "go test",
        "coverage_tool": "go coverage",
        "command": "go test -covermode=atomic -coverprofile=coverage.out ./..."
      },
      "rust": {
        "framework": "cargo test",
        "coverage_tool": "tarpaulin or llvm-cov",
        "command": "cargo tarpaulin --out Stdout --timeout 120"
      },
      "php": {
        "framework": "PHPUnit",
        "coverage_tool": "PHPUnit coverage",
        "command": "phpunit --coverage-html=coverage"
      },
      "ruby": {
        "framework": "RSpec or Minitest",
        "coverage_tool": "simplecov",
        "command": "bundle exec rspec --coverage"
      },
      "swift": {
        "framework": "XCTest",
        "coverage_tool": "Xcode code coverage",
        "command": "swift test --coverage"
      },
      "kotlin": {
        "framework": "JUnit",
        "coverage_tool": "JaCoCo",
        "command": "gradle test jacocoTestReport"
      },
      "r": {
        "framework": "testthat",
        "coverage_tool": "covr",
        "command": "covr::package_coverage()"
      },
      "matlab": {
        "framework": "matlab.unittest",
        "coverage_tool": "matlab.codetools.coverage",
        "command": "runtests('Tests')"
      }
    }
  },
  "linting_requirements": {
    "enforcement": "strict with zero warnings or errors",
    "suppressions": "not allowed",
    "language_standards": {
      "python": {
        "tools": [
          "mypy (strict mode)",
          "ruff",
          "flake8"
        ],
        "config_files": [
          ".flake8",
          "pyproject.toml",
          "ruff.toml"
        ],
        "strict_modes": [
          "--strict (mypy)",
          "extend-select=E,W,F (ruff)"
        ]
      },
      "javascript": {
        "tools": [
          "ESLint (strict)",
          "Prettier"
        ],
        "config_files": [
          ".eslintrc.js",
          "eslint.config.mjs"
        ],
        "strict_modes": [
          "extends: 'eslint:recommended'"
        ]
      },
      "typescript": {
        "tools": [
          "ESLint (strict)",
          "TypeScript strict mode",
          "Prettier"
        ],
        "config_files": [
          "tsconfig.json",
          ".eslintrc.js"
        ],
        "strict_modes": [
          "strict: true (tsconfig.json)"
        ]
      },
      "java": {
        "tools": [
          "SpotBugs",
          "Checkstyle"
        ],
        "config_files": [
          "checkstyle.xml",
          "spotbugs.xml"
        ],
        "strict_modes": [
          "all rules enabled"
        ]
      },
      "c": {
        "tools": [
          "clang-tidy",
          "compiler warnings as errors"
        ],
        "config_files": [
          ".clang-tidy"
        ],
        "strict_modes": [
          "-Wall -Werror -Wextra -pedantic"
        ]
      },
      "cpp": {
        "tools": [
          "clang-tidy",
          "compiler warnings as errors"
        ],
        "config_files": [
          ".clang-tidy"
        ],
        "strict_modes": [
          "-Wall -Werror -Wextra -pedantic -std=c++17"
        ]
      },
      "csharp": {
        "tools": [
          "Roslyn analyzers",
          "nullable reference types"
        ],
        "config_files": [
          ".editorconfig"
        ],
        "strict_modes": [
          "<Nullable>enable</Nullable>"
        ]
      },
      "go": {
        "tools": [
          "go vet",
          "staticcheck"
        ],
        "config_files": [
          "golangci.yml"
        ],
        "strict_modes": [
          "all linters enabled"
        ]
      },
      "rust": {
        "tools": [
          "clippy (deny warnings)"
        ],
        "config_files": [
          "clippy.toml"
        ],
        "strict_modes": [
          "#![deny(warnings)]"
        ]
      },
      "php": {
        "tools": [
          "PHPStan (max level)",
          "PHP_CodeSniffer"
        ],
        "config_files": [
          "phpstan.neon"
        ],
        "strict_modes": [
          "level: 9"
        ]
      },
      "ruby": {
        "tools": [
          "RuboCop"
        ],
        "config_files": [
          ".rubocop.yml"
        ],
        "strict_modes": [
          "all cops enabled"
        ]
      },
      "swift": {
        "tools": [
          "SwiftLint"
        ],
        "config_files": [
          ".swiftlint.yml"
        ],
        "strict_modes": [
          "all rules enabled"
        ]
      },
      "kotlin": {
        "tools": [
          "Detekt"
        ],
        "config_files": [
          "detekt.yml"
        ],
        "strict_modes": [
          "all rules enabled"
        ]
      },
      "r": {
        "tools": [
          "lintr"
        ],
        "config_files": [
          ".lintr"
        ],
        "strict_modes": [
          "all linters enabled"
        ]
      },
      "matlab": {
        "tools": [
          "code analyzer with all warnings enabled"
        ],
        "config_files": [],
        "strict_modes": [
          "all warnings enabled in checkcode()"
        ]
      }
    }
  },
  "implementation_requirements": {
    "mandatory": [
      "Every function, class, method, and module must be fully implemented",
      "All logic paths handled; no unhandled branches or undefined behavior",
      "All dependencies must be real, explicit, pinned, and installable",
      "Configuration must be concrete, production-ready, and validated",
      "Inputs/outputs fully specified with strict validation",
      "Comprehensive, explicit error handling",
      "Deterministic behavior",
      "The code must run as-is without modification"
    ]
  },
  "performance_constraints": {
    "mandatory": [
      "Define explicit time and memory limits appropriate to the problem domain",
      "Enforce performance with measurable benchmarks or assertions",
      "Avoid unnecessary allocations and superlinear algorithms",
      "Ensure worst-case behavior respects the stated limits"
    ]
  },
  "quality_bar": {
    "standards": [
      "Production-ready, idiomatic, robust",
      "Correctness over brevity",
      "Clean architecture, no dead code",
      "Clear, precise naming",
      "Security-conscious defaults"
    ]
  },
  "intent_classification": {
    "code_write_confidence_threshold": 0.8,
    "high_confidence_gates": true
  },
  "plan_resolution": {
    "search_paths": [
      "PLAN.md",
      ".plan/PLAN.md",
      "docs/PLAN.md",
      "docs/architecture/PLAN.md",
      ".github/PLAN.md"
    ],
    "auto_enforce_scope": false,
    "require_scope_declaration": false
  },
  "diff_quality": {
    "max_lines_per_edit": 100,
    "max_total_lines": 500,
    "max_files_per_pass": 10,
    "min_comment_ratio_for_generated": 0.1,
    "ship_mode_enforces_quality": true
  },
  "filesystem_write": {
    "max_new_files": 50,
    "protected_paths": [
      "/usr/local/share/windsurf-hooks/",
      "/etc/windsurf/policy/",
      "/.local/share/windsurf-hooks/",
      "/etc/windsurf/"
    ],
    "protected_paths_comment": "These paths are READ-ONLY. All modifications must use atlas_gate.write tool.",
    "suspicious_patterns": [
      "node_modules",
      "\\.git",
      "\\.env",
      "__pycache__",
      "dist",
      "build",
      "\\.cache",
      "\\.tmp",
      "venv"
    ],
    "suspicious_extensions": [
      ".exe",
      ".dll",
      ".so",
      ".bin",
      ".pyc",
      ".o",
      ".a",
      ".iso",
      ".dmg"
    ]
  },
  "observability": {
    "min_lines_for_logging": 10,
    "min_lines_for_metrics": 20,
    "enforce_in_ship_mode": true,
    "require_tracing": false
  },
  "session_entropy": {
    "circular_retry_threshold": 3,
    "entropy_alert_threshold": 0.7,
    "escalation_mode": "plan"
  },
  "atlas_gate": {
    "enabled": true,
    "enforce_mode": "strict",
    "operations": {
      "atlas_gate.read": {
        "required_fields": [
          "path"
        ],
        "optional_fields": [
          "encoding",
          "max_bytes"
        ],
        "description": "Read file via ATLAS-GATE"
      },
      "atlas_gate.write": {
        "required_fields": [
          "path",
          "content"
        ],
        "optional_fields": [
          "mode",
          "encoding"
        ],
        "description": "Write file via ATLAS-GATE"
      },
      "atlas_gate.exec": {
        "required_fields": [
          "command"
        ],
        "optional_fields": [
          "timeout",
          "env"
        ],
        "description": "Execute command via ATLAS-GATE"
      },
      "atlas_gate.stat": {
        "required_fields": [
          "path"
        ],
        "optional_fields": [],
        "description": "Stat file via ATLAS-GATE"
      }
    },
    "filesystem": {
      "direct_read": false,
      "direct_write": false,
      "direct_exec": false,
      "comment": "All operations must go through ATLAS-GATE tools"
    },
    "forbidden_paths": {
      ".ssh": "SSH keys and config",
      ".aws": "AWS credentials",
      ".env": "Environment files",
      ".git/config": "Git configuration",
      "/etc": "System configuration",
      "/proc": "Process files",
      "/sys": "System kernel",
      "/root": "Root home directory",
      "/var/log": "System logs"
    },
    "forbidden_extensions": {
      ".exe": "Windows executable",
      ".dll": "Windows DLL",
      ".so": "Unix shared object",
      ".bin": "Binary blob",
      ".pyc": "Python compiled",
      ".jar": "Java archive",
      ".iso": "Disk image",
      ".dmg": "macOS image"
    },
    "escape_patterns": [
      "subprocess\\.",
      "os\\.system",
      "os\\.popen",
      "exec\\(",
      "eval\\(",
      "compile\\(",
      "__import__\\(",
      "socket\\.",
      "urllib\\.",
      "ctypes\\.",
      "cffi\\.",
      "bash -c",
      "sh -c",
      "cmd /c"
    ]
  }
}